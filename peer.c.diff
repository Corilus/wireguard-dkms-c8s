--- wireguard-linux-compat-1.0.20220627/src/peer.c.orig	2023-07-05 16:11:05.238646200 +0200
+++ wireguard-linux-compat-1.0.20220627/src/peer.c	2023-07-05 16:11:17.843191100 +0200
@@ -54,7 +54,7 @@
 	skb_queue_head_init(&peer->staged_packet_queue);
 	wg_noise_reset_last_sent_handshake(&peer->last_sent_handshake);
 	set_bit(NAPI_STATE_NO_BUSY_POLL, &peer->napi.state);
-	netif_napi_add(wg->dev, &peer->napi, wg_packet_rx_poll,
+	netif_napi_add_weight(wg->dev, &peer->napi, wg_packet_rx_poll,
 		       NAPI_POLL_WEIGHT);
 	napi_enable(&peer->napi);
 	list_add_tail(&peer->peer_list, &wg->peer_list);
